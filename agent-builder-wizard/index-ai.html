<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI-Powered Agent Builder Wizard - PM Agent Squad Master</title>
    <link rel="icon" type="image/x-icon" href="favicon.ico">
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="td-theme.css">
    <style>
        .step-content {
            display: none;
        }
        .step-content.active {
            display: block;
        }
        .step-indicator {
            opacity: 0.5;
        }
        .step-indicator.active {
            opacity: 1;
        }
        .step-indicator.completed {
            opacity: 1;
        }
        .kb-editor {
            font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
        }
        .ai-message {
            animation: slideIn 0.3s ease-out;
        }
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        .typing-indicator {
            display: inline-flex;
            gap: 4px;
        }
        .typing-dot {
            width: 8px;
            height: 8px;
            background: #6366f1;
            border-radius: 50%;
            animation: typing 1.4s infinite;
        }
        .typing-dot:nth-child(2) {
            animation-delay: 0.2s;
        }
        .typing-dot:nth-child(3) {
            animation-delay: 0.4s;
        }
        @keyframes typing {
            0%, 60%, 100% {
                opacity: 0.3;
                transform: scale(0.8);
            }
            30% {
                opacity: 1;
                transform: scale(1);
            }
        }
        /* Drag and Drop Styles */
        .draggable-section {
            cursor: grab;
        }
        .draggable-section:active {
            cursor: grabbing;
        }
        .draggable-section.dragging {
            opacity: 0.5;
            transform: scale(0.98);
        }
        .draggable-section.drag-over {
            border: 2px dashed #6366f1;
            background-color: #f0f0ff;
        }
        .drag-handle {
            cursor: move;
            transition: all 0.2s;
        }
        .drag-handle:hover {
            transform: scale(1.1);
        }
    </style>
</head>
<body class="bg-gradient-to-br from-indigo-50 via-white to-purple-50 min-h-screen">
    <!-- API Connection Status Modal -->
    <div id="apiKeyModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
        <div class="bg-white rounded-lg shadow-xl p-6 max-w-md w-full mx-4">
            <h3 class="text-xl font-bold text-gray-900 mb-4">üîå API Connection Status</h3>

            <!-- Dynamic status container - will be populated by JavaScript -->
            <div id="apiModalStatusContainer">
                <!-- Default loading state -->
                <div class="bg-gray-50 border border-gray-200 rounded-lg p-4 mb-4">
                    <div class="flex items-center gap-3">
                        <span class="text-2xl">‚è≥</span>
                        <div>
                            <p class="font-semibold text-gray-900">Checking Connection...</p>
                            <p class="text-sm text-gray-700">Testing connection to localhost:3001</p>
                        </div>
                    </div>
                </div>
            </div>

            <p class="text-xs text-gray-500 mb-4">
                This application uses the Claude Code CLI running locally on your machine. No API key configuration needed.
            </p>

            <button
                id="closeApiModalBtn"
                class="w-full bg-indigo-600 hover:bg-indigo-700 text-white font-semibold py-2 px-4 rounded-lg transition-colors"
            >
                Close
            </button>
        </div>
    </div>

    <div class="container mx-auto px-4 py-8 max-w-7xl">
        <!-- Header -->
        <div class="text-center mb-8">
            <div class="flex items-center justify-center gap-3 mb-2">
                <img src="favicon.ico" alt="Treasure Data" class="w-12 h-12">
                <h1 class="text-4xl font-bold text-indigo-900" data-i18n="page.title">AI-Powered Agent Builder</h1>
            </div>
            <p class="text-gray-600" data-i18n="page.subtitle">Describe your agent, and I'll help you build it step-by-step</p>
            <div class="flex items-center justify-center gap-4 mt-2">
                <p class="text-sm text-gray-500">Powered by Claude Code AI ‚Ä¢ PM Agent Squad Master Template</p>

                <!-- Global Language Settings -->
                <div class="flex items-center gap-2 bg-white rounded-full px-4 py-1 shadow-sm border border-gray-200">
                    <span class="text-xs text-gray-600">üåç</span>
                    <select id="globalLanguage" class="text-xs bg-transparent border-none focus:ring-0 focus:outline-none text-gray-700 font-medium cursor-pointer">
                        <option value="english">English</option>
                        <option value="japanese">Êó•Êú¨Ë™û</option>
                        <option value="multilingual">üåê Auto-Detect</option>
                        <option value="portuguese">Portugu√™s</option>
                        <option value="spanish">Espa√±ol</option>
                        <option value="french">Fran√ßais</option>
                        <option value="german">Deutsch</option>
                        <option value="italian">Italiano</option>
                        <option value="korean">ÌïúÍµ≠Ïñ¥</option>
                        <option value="dutch">Nederlands</option>
                    </select>
                </div>

                <button
                    id="configureApiBtn"
                    class="text-xs bg-indigo-100 hover:bg-indigo-200 text-indigo-700 px-3 py-1 rounded-full transition-colors"
                    title="Configure API Key"
                >
                    <span id="apiStatusIndicator">üî¥</span> API Settings
                </button>
            </div>
        </div>

        <div id="draggableContainer" class="grid grid-cols-1 lg:grid-cols-3 gap-6">
            <!-- Left Side: AI Assistant Panel -->
            <div id="assistantPanel" class="lg:col-span-1 draggable-section" draggable="false" data-section="assistant">
                <div class="bg-white rounded-lg shadow-lg p-6 sticky top-4 transition-all duration-200">
                    <div class="flex items-center gap-2 mb-4 pb-4 border-b border-gray-200">
                        <button class="drag-handle cursor-move text-gray-400 hover:text-gray-600 transition-colors" title="Drag to reorder">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 8h16M4 16h16"></path>
                            </svg>
                        </button>
                        <div class="w-10 h-10 bg-white rounded-full flex items-center justify-center p-1 shadow-sm border border-gray-200">
                            <img src="favicon.ico" alt="TD" class="w-full h-full">
                        </div>
                        <div class="flex-1">
                            <h3 class="font-bold text-gray-900" data-i18n="assistant.title">Agent Foundry Assistant</h3>
                            <p class="text-xs text-gray-500" data-i18n="assistant.subtitle">Your agent building assistant</p>
                        </div>
                    </div>

                    <!-- Chat Messages -->
                    <div id="aiChatMessages" class="space-y-4 mb-4 max-h-96 overflow-y-auto">
                        <!-- Initial message -->
                        <div class="ai-message bg-gradient-to-br from-indigo-50 to-purple-50 rounded-lg p-4 border border-indigo-100">
                            <p class="text-sm text-gray-800" id="welcomeMessage">
                                <span data-i18n="assistant.welcome">üëã Hi! I'm your Agent Foundry Assistant. I'll help you build a custom AI Foundry Agent.</span>
                                <br><br>
                                <span data-i18n="assistant.start"><strong>Let's start:</strong> What kind of agent do you want to build? Describe what it should do.</span>
                            </p>
                        </div>
                    </div>

                    <!-- Chat Input -->
                    <div class="space-y-2">
                        <textarea
                            id="aiChatInput"
                            rows="3"
                            class="w-full border border-gray-300 rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-indigo-500 focus:border-transparent resize-none"
                            placeholder="Example: I want to build a campaign planning agent that helps marketers create comprehensive marketing campaigns across multiple channels..."
                        ></textarea>
                        <!-- Error message for empty input -->
                        <div id="chatInputError" class="text-red-600 text-sm font-medium" style="display: none;">
                            ‚ö†Ô∏è Please enter a message before sending
                        </div>
                        <button
                            id="aiSendBtn"
                            class="w-full bg-indigo-600 hover:bg-indigo-700 text-white font-semibold py-2 px-4 rounded-lg transition-colors duration-200"
                            data-i18n="button.ask"
                        >
                            Ask Assistant
                        </button>
                        <button
                            id="aiStopBtn"
                            class="w-full bg-red-600 hover:bg-red-700 text-white font-semibold py-2 px-4 rounded-lg transition-colors duration-200"
                            style="display: none;"
                            data-i18n="button.stop"
                        >
                            ‚èπÔ∏è Stop Response
                        </button>
                        <button
                            id="aiGenerateBtn"
                            class="w-full bg-gradient-to-r from-purple-600 to-indigo-600 hover:from-purple-700 hover:to-indigo-700 text-white font-semibold py-2 px-4 rounded-lg transition-all duration-200"
                            data-i18n="button.generate"
                        >
                            ‚ú® Auto-Generate Agent
                        </button>
                        <button
                            id="cancelGenerateBtn"
                            class="w-full bg-red-600 hover:bg-red-700 text-white font-semibold py-2 px-4 rounded-lg transition-colors duration-200"
                            style="display: none;"
                            data-i18n="button.cancel"
                        >
                            ‚úñÔ∏è Cancel Generation
                        </button>
                        <button
                            id="resetBtn"
                            class="w-full bg-gray-200 hover:bg-gray-300 text-gray-700 font-semibold py-2 px-4 rounded-lg transition-colors duration-200"
                            data-i18n="button.reset"
                        >
                            üîÑ Start Over
                        </button>
                    </div>

                    <!-- Quick Actions -->
                    <div class="mt-4 pt-4 border-t border-gray-200">
                        <p class="text-xs font-semibold text-gray-600 mb-2" data-i18n="examples.title">Quick Examples:</p>
                        <div class="space-y-2">
                            <button class="quick-example w-full text-left text-xs bg-gray-50 hover:bg-gray-100 rounded px-3 py-2 transition-colors" data-example="campaign-building" data-i18n="example.campaign">
                                üéØ Campaign Building
                            </button>
                            <button class="quick-example w-full text-left text-xs bg-gray-50 hover:bg-gray-100 rounded px-3 py-2 transition-colors" data-example="campaign-optimization" data-i18n="example.optimization">
                                üìä Campaign Optimization
                            </button>
                            <button class="quick-example w-full text-left text-xs bg-gray-50 hover:bg-gray-100 rounded px-3 py-2 transition-colors" data-example="campaign-reporting" data-i18n="example.reporting">
                                üìà Campaign Reporting
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Right Side: Wizard Steps -->
            <div id="wizardPanel" class="lg:col-span-2 draggable-section" draggable="false" data-section="wizard">
                <div class="transition-all duration-200">
                    <!-- Drag Handle -->
                    <div class="bg-white rounded-t-lg shadow-md p-2 flex items-center justify-center">
                        <button class="drag-handle cursor-move text-gray-400 hover:text-gray-600 transition-colors" title="Drag to reorder">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 8h16M4 16h16"></path>
                            </svg>
                        </button>
                    </div>
                </div>
                <!-- Progress Steps -->
                <div class="bg-white rounded-lg shadow-md p-4 mb-6">
                    <div class="flex items-center justify-between overflow-x-auto pb-2">
                        <div class="step-indicator active flex-1 text-center min-w-[60px]" data-step="0">
                            <div class="w-8 h-8 mx-auto bg-indigo-600 text-white rounded-full flex items-center justify-center text-sm font-bold mb-1">0</div>
                            <p class="text-xs font-medium" data-i18n="step.describe">Describe</p>
                        </div>
                        <div class="flex-1 h-1 bg-gray-200 mx-1"></div>
                        <div class="step-indicator flex-1 text-center min-w-[70px]" data-step="1">
                            <div class="w-8 h-8 mx-auto bg-gray-300 text-white rounded-full flex items-center justify-center text-sm font-bold mb-1">1</div>
                            <p class="text-xs font-medium" data-i18n="step.knowledge">Knowledge</p>
                        </div>
                        <div class="flex-1 h-1 bg-gray-200 mx-1"></div>
                        <div class="step-indicator flex-1 text-center min-w-[60px]" data-step="2">
                            <div class="w-8 h-8 mx-auto bg-gray-300 text-white rounded-full flex items-center justify-center text-sm font-bold mb-1">2</div>
                            <p class="text-xs font-medium" data-i18n="step.project">Project</p>
                        </div>
                        <div class="flex-1 h-1 bg-gray-200 mx-1"></div>
                        <div class="step-indicator flex-1 text-center min-w-[60px]" data-step="3">
                            <div class="w-8 h-8 mx-auto bg-gray-300 text-white rounded-full flex items-center justify-center text-sm font-bold mb-1">3</div>
                            <p class="text-xs font-medium" data-i18n="step.agent">Agent</p>
                        </div>
                        <div class="flex-1 h-1 bg-gray-200 mx-1"></div>
                        <div class="step-indicator flex-1 text-center min-w-[60px]" data-step="4">
                            <div class="w-8 h-8 mx-auto bg-gray-300 text-white rounded-full flex items-center justify-center text-sm font-bold mb-1">4</div>
                            <p class="text-xs font-medium" data-i18n="step.tools">Tools</p>
                        </div>
                        <div class="flex-1 h-1 bg-gray-200 mx-1"></div>
                        <div class="step-indicator flex-1 text-center min-w-[60px]" data-step="5">
                            <div class="w-8 h-8 mx-auto bg-gray-300 text-white rounded-full flex items-center justify-center text-sm font-bold mb-1">5</div>
                            <p class="text-xs font-medium" data-i18n="step.outputs">Outputs</p>
                        </div>
                        <div class="flex-1 h-1 bg-gray-200 mx-1"></div>
                        <div class="step-indicator flex-1 text-center min-w-[70px]" data-step="6">
                            <div class="w-8 h-8 mx-auto bg-gray-300 text-white rounded-full flex items-center justify-center text-sm font-bold mb-1">6</div>
                            <p class="text-xs font-medium" data-i18n="step.variables">Variables</p>
                        </div>
                        <div class="flex-1 h-1 bg-gray-200 mx-1"></div>
                        <div class="step-indicator flex-1 text-center min-w-[60px]" data-step="7">
                            <div class="w-8 h-8 mx-auto bg-gray-300 text-white rounded-full flex items-center justify-center text-sm font-bold mb-1">7</div>
                            <p class="text-xs font-medium" data-i18n="step.deploy">Deploy</p>
                        </div>
                    </div>
                </div>

                <!-- Main Content Card -->
                <div class="bg-white rounded-lg shadow-lg p-8">

                    <!-- Step 0: Describe Your Agent (NEW AI-First Step) -->
                    <div class="step-content active" data-step="0">
                        <h2 class="text-2xl font-bold text-indigo-900 mb-4" data-i18n="step0.title">üéØ Step 0: Describe Your Agent</h2>

                        <div class="bg-gradient-to-r from-indigo-50 to-purple-50 border-l-4 border-indigo-500 p-4 mb-6">
                            <p class="text-sm text-indigo-900" data-i18n="step0.info">
                                <strong>AI-Powered Building:</strong> Tell Claude what your agent needs to do, and it will automatically generate knowledge bases, configuration, and deployment files for you.
                            </p>
                        </div>

                        <div class="space-y-6">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">
                                    <span data-i18n="step0.purpose">What is your agent's purpose?</span> <span class="text-red-500">*</span>
                                </label>
                                <textarea
                                    id="agentDescription"
                                    rows="6"
                                    class="w-full border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-indigo-500 focus:border-transparent"
                                    placeholder="Example: I need a campaign planning agent that helps marketers with:
- Creating comprehensive marketing campaign strategies
- Planning multi-channel campaigns (Meta, Google, TikTok, Pinterest)
- Optimizing campaign performance and budget allocation
- Analyzing campaign metrics and generating reports
- Providing best practices for paid media advertising

The agent should be strategic, data-driven, and provide actionable recommendations based on campaign planning frameworks and advertising best practices."
                                ></textarea>
                                <p class="text-xs text-gray-500 mt-1" data-i18n="step0.hint">
                                    Be specific! Include what the agent should do, who will use it, and what knowledge it needs.
                                </p>
                            </div>

                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2" data-i18n="step0.tone">
                                    What tone should your agent have?
                                </label>
                                <select id="agentTone" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-indigo-500 focus:border-transparent">
                                    <option value="professional" data-i18n="tone.professional">Professional & Formal</option>
                                    <option value="friendly" data-i18n="tone.friendly">Friendly & Conversational</option>
                                    <option value="empathetic" data-i18n="tone.empathetic">Empathetic & Supportive</option>
                                    <option value="technical" data-i18n="tone.technical">Technical & Precise</option>
                                    <option value="enthusiastic" data-i18n="tone.enthusiastic">Enthusiastic & Energetic</option>
                                </select>
                            </div>

                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2" data-i18n="step0.audience">
                                    Who will use this agent?
                                </label>
                                <input
                                    type="text"
                                    id="agentAudience"
                                    class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-indigo-500 focus:border-transparent"
                                    placeholder="Example: Company employees, customers, internal team members..."
                                />
                            </div>

                            <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4">
                                <p class="text-sm text-yellow-900" data-i18n="step0.tip">
                                    <strong>üí° Tip:</strong> The more detail you provide, the better Claude can generate your agent configuration. Include specific examples of questions users might ask or tasks they need help with.
                                </p>
                            </div>
                        </div>
                    </div>

                    <!-- Step 1: Knowledge Bases (AI-Generated) -->
                    <div class="step-content" data-step="1">
                        <h2 class="text-2xl font-bold text-indigo-900 mb-4" data-i18n="step1.title">üìö Step 1: Review Knowledge Bases</h2>

                        <div class="bg-green-50 border-l-4 border-green-500 p-4 mb-6">
                            <p class="text-sm text-green-900" data-i18n="step1.info">
                                <strong>‚ú® AI-Generated:</strong> Based on your description, Claude has created these knowledge bases for your agent. Review and edit as needed.
                            </p>
                        </div>

                        <div id="knowledgeBasesList" class="space-y-4">
                            <!-- AI-generated KBs will be inserted here -->
                            <div class="text-center py-12 text-gray-400">
                                <p>Complete Step 0 to generate knowledge bases</p>
                            </div>
                        </div>

                        <button
                            id="addKBBtn"
                            class="mt-4 bg-indigo-100 hover:bg-indigo-200 text-indigo-700 font-semibold py-2 px-4 rounded-lg transition-colors duration-200"
                            data-i18n="button.addkb"
                        >
                            ‚ûï Add Another Knowledge Base
                        </button>
                    </div>

                    <!-- Step 2: Project Setup (AI-Generated) -->
                    <div class="step-content" data-step="2">
                        <h2 class="text-2xl font-bold text-indigo-900 mb-4" data-i18n="step2.title">‚öôÔ∏è Step 2: Review Project Setup</h2>

                        <div class="bg-green-50 border-l-4 border-green-500 p-4 mb-6">
                            <p class="text-sm text-green-900" data-i18n="step2.info">
                                <strong>‚ú® AI-Generated:</strong> Claude has configured your project settings. Review and modify if needed.
                            </p>
                            <p class="text-sm text-green-900 mt-2" data-i18n="step2.next">
                                <strong>üìç Next Step:</strong> After completing this wizard, open <a href="https://console.treasuredata.com/app/agents" target="_blank" class="text-indigo-600 hover:text-indigo-800 underline font-semibold">Treasure Data ‚Üí AI Agent Foundry</a> to deploy your agent.
                            </p>
                        </div>

                        <div class="space-y-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">
                                    <span data-i18n="step2.name">Project Name</span> <span class="text-red-500">*</span>
                                </label>
                                <input
                                    type="text"
                                    id="projectName"
                                    class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-indigo-500 focus:border-transparent"
                                    placeholder="Example: Employee HR Support System"
                                />
                            </div>

                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">
                                    <span data-i18n="step2.description">Project Description</span> <span class="text-red-500">*</span>
                                </label>
                                <textarea
                                    id="projectDescription"
                                    rows="4"
                                    class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-indigo-500 focus:border-transparent"
                                    placeholder="Comprehensive description of your project..."
                                ></textarea>
                            </div>
                        </div>
                    </div>

                    <!-- Step 3: Agent Configuration (AI-Generated) -->
                    <div class="step-content" data-step="3">
                        <h2 class="text-2xl font-bold text-indigo-900 mb-4" data-i18n="step3.title">ü§ñ Step 3: Review Agent Configuration</h2>

                        <div class="bg-green-50 border-l-4 border-green-500 p-4 mb-6">
                            <p class="text-sm text-green-900" data-i18n="step3.info">
                                <strong>‚ú® AI-Generated:</strong> Claude has selected optimal settings for your agent. Customize if needed.
                            </p>
                        </div>

                        <div class="space-y-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">
                                    <span data-i18n="step3.name">Agent Display Name</span> <span class="text-red-500">*</span>
                                </label>
                                <input
                                    type="text"
                                    id="agentName"
                                    class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-indigo-500 focus:border-transparent"
                                />
                            </div>

                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">
                                    <span data-i18n="step3.model">AI Model</span> <span class="text-red-500">*</span>
                                </label>
                                <select id="modelSelect" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-indigo-500 focus:border-transparent">
                                    <option value="anthropic.claude-3-5-sonnet-20241022-v2:0">Claude 3.5 Sonnet v2 (Recommended)</option>
                                    <option value="anthropic.claude-3-5-haiku-20241022-v1:0">Claude 3.5 Haiku</option>
                                    <option value="anthropic.claude-3-opus-20240229-v1:0">Claude 3 Opus</option>
                                    <option value="openai.gpt-4o">GPT-4o</option>
                                    <option value="openai.gpt-4o-mini">GPT-4o Mini</option>
                                    <option value="amazon.nova-pro-v1:0">Amazon Nova Pro</option>
                                    <option value="amazon.nova-lite-v1:0">Amazon Nova Lite</option>
                                    <option value="meta.llama3-1-405b-instruct-v1:0">Llama 3.1 405B</option>
                                </select>
                                <p id="modelRecommendation" class="text-xs text-indigo-600 mt-1"></p>

                                <!-- AI Model Reasoning -->
                                <div id="modelReasoningSection" class="mt-3 p-3 bg-indigo-50 border border-indigo-200 rounded-lg" style="display: none;">
                                    <div class="flex items-start gap-2">
                                        <span class="text-indigo-600 text-sm">üí°</span>
                                        <div>
                                            <p class="text-xs font-semibold text-indigo-900 mb-1">Why this model?</p>
                                            <p id="modelReasoningText" class="text-xs text-indigo-700"></p>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2" data-i18n="step3.maxToolsIterations">
                                    Max Tools Iterations
                                </label>
                                <div class="flex items-center gap-3">
                                    <input
                                        type="range"
                                        id="maxToolsIterations"
                                        min="0"
                                        max="10"
                                        step="1"
                                        value="0"
                                        class="flex-1"
                                    />
                                    <input
                                        type="number"
                                        id="maxToolsIterationsInput"
                                        min="0"
                                        max="10"
                                        step="1"
                                        value="0"
                                        class="w-20 border border-gray-300 rounded-lg px-3 py-1.5 text-center text-sm focus:ring-2 focus:ring-indigo-500 focus:border-transparent"
                                    />
                                </div>
                                <p class="text-xs text-gray-500 mt-1" data-i18n="step3.maxToolsIterations.tip">
                                    Tool iterations allow the agent to refine and improve tool calls. Range: 0-10 (0 = no iterations)
                                </p>
                            </div>

                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2" data-i18n="step3.temperature">
                                    Temperature
                                </label>
                                <div class="flex items-center gap-3">
                                    <input
                                        type="range"
                                        id="temperature"
                                        min="0"
                                        max="1"
                                        step="0.1"
                                        value="0.5"
                                        class="flex-1"
                                    />
                                    <input
                                        type="number"
                                        id="temperatureInput"
                                        min="0"
                                        max="1"
                                        step="0.1"
                                        value="0.5"
                                        class="w-20 border border-gray-300 rounded-lg px-3 py-1.5 text-center text-sm focus:ring-2 focus:ring-indigo-500 focus:border-transparent"
                                    />
                                </div>
                                <p class="text-xs text-gray-500 mt-1" data-i18n="step3.temp.tip">
                                    Controls randomness: 0.0-1.0. Lower = More precise | Higher = More creative
                                </p>
                            </div>

                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">
                                    <span data-i18n="step3.prompt">System Prompt</span> <span class="text-red-500">*</span>
                                </label>
                                <textarea
                                    id="systemPrompt"
                                    rows="8"
                                    class="w-full border border-gray-300 rounded-lg px-4 py-2 font-mono text-sm focus:ring-2 focus:ring-indigo-500 focus:border-transparent"
                                ></textarea>
                                <div class="flex justify-between items-center mt-1">
                                    <p class="text-xs text-gray-500" data-i18n="step3.prompt.tip">AI-generated system prompt based on your description</p>
                                    <button id="regeneratePromptBtn" class="text-xs text-indigo-600 hover:text-indigo-700" data-i18n="button.regenerate">
                                        üîÑ Regenerate
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Step 4: Tools Review -->
                    <div class="step-content" data-step="4">
                        <h2 class="text-2xl font-bold text-indigo-900 mb-4">üîß Step 4: Review & Add Tools</h2>

                        <p class="text-gray-700 mb-4">
                            Review auto-generated Knowledge Base tools and optionally add specialized tools to extend your agent's capabilities.
                        </p>

                        <!-- Auto-Generated KB Tools Section -->
                        <div class="mb-8">
                            <h3 class="text-lg font-semibold text-gray-900 mb-3">üìö Auto-Generated Knowledge Base Tools</h3>
                            <div class="bg-green-50 border-l-4 border-green-500 p-4 mb-4">
                                <p class="text-sm text-green-900">
                                    <strong>‚úÖ Auto-Generated:</strong> These tools were created from your knowledge bases. They allow your agent to search and retrieve information.
                                </p>
                            </div>

                            <div id="knowledgeBaseToolsList" class="space-y-3">
                                <!-- Auto-generated KB tools will be displayed here -->
                            </div>
                        </div>

                        <!-- Additional Tools Section -->
                        <div class="border-t pt-6">
                            <h3 class="text-lg font-semibold text-gray-900 mb-3">üõ†Ô∏è Additional Specialized Tools (Optional)</h3>
                            <div class="bg-blue-50 border-l-4 border-blue-500 p-4 mb-4">
                                <p class="text-sm text-blue-900">
                                    <strong>‚ÑπÔ∏è Optional:</strong> Add specialized tools like Agent calls, Image Generation, or Workflow Execution.
                                </p>
                            </div>

                            <div id="additionalToolsList" class="space-y-4 mb-4">
                                <!-- Manually-added tools will be added here -->
                            </div>

                            <button id="addToolBtn" class="bg-indigo-600 hover:bg-indigo-700 text-white font-semibold py-3 px-6 rounded-lg transition-colors">
                                ‚ûï Add Specialized Tool
                            </button>

                            <div class="mt-4 bg-gray-50 rounded-lg p-4">
                                <h4 class="font-semibold text-gray-900 mb-2">Available Tool Types:</h4>
                                <ul class="text-sm text-gray-700 space-y-2">
                                    <li><strong>Agent Tool:</strong> Call another specialized agent</li>
                                    <li><strong>Image Generator:</strong> Create or edit images</li>
                                    <li><strong>Workflow Executor:</strong> Run complex multi-step workflows</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <!-- Step 5: Configure Outputs (Optional) -->
                    <div class="step-content" data-step="5">
                        <h2 class="text-2xl font-bold text-indigo-900 mb-4">üì§ Step 5: Configure Outputs (Optional)</h2>

                        <p class="text-gray-700 mb-4">
                            Configure how your agent returns data. Define custom structured outputs for specific use cases or use the default text response.
                        </p>

                        <!-- Default Output Section -->
                        <div class="mb-8">
                            <h3 class="text-lg font-semibold text-gray-900 mb-3">üìù Default Text Output</h3>
                            <div class="bg-green-50 border-l-4 border-green-500 p-4 mb-4">
                                <p class="text-sm text-green-900">
                                    <strong>‚úÖ Always Available:</strong> Your agent will automatically return text responses with markdown formatting support. No configuration needed!
                                </p>
                            </div>

                            <div class="bg-white border border-gray-200 rounded-lg p-4">
                                <div class="flex items-start gap-3">
                                    <div class="flex-shrink-0 text-2xl">‚úÖ</div>
                                    <div class="flex-1">
                                        <h4 class="font-semibold text-gray-900 mb-2">Default Capabilities:</h4>
                                        <ul class="text-sm text-gray-700 space-y-1.5">
                                            <li>‚Ä¢ Returns natural language responses</li>
                                            <li>‚Ä¢ Supports markdown formatting (bold, italic, lists, code blocks)</li>
                                            <li>‚Ä¢ No setup required - works out of the box</li>
                                            <li>‚Ä¢ Perfect for conversational agents and general Q&A</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Custom Outputs Section -->
                        <div class="border-t pt-6">
                            <h3 class="text-lg font-semibold text-gray-900 mb-3">üé® Custom Structured Outputs (Optional)</h3>
                            <div class="bg-blue-50 border-l-4 border-blue-500 p-4 mb-4">
                                <p class="text-sm text-blue-900">
                                    <strong>‚ÑπÔ∏è Optional:</strong> Add custom outputs when you need structured JSON data, charts, or special formatting beyond plain text.
                                </p>
                            </div>

                            <div id="outputsList" class="space-y-4 mb-4">
                                <!-- Custom outputs will be added here -->
                            </div>

                            <button id="addOutputBtn" class="bg-indigo-600 hover:bg-indigo-700 text-white font-semibold py-3 px-6 rounded-lg transition-colors">
                                ‚ûï Add Custom Output
                            </button>

                            <div class="mt-4 bg-gray-50 rounded-lg p-4">
                                <h4 class="font-semibold text-gray-900 mb-3">Available Output Types:</h4>

                                <div class="space-y-3">
                                    <div class="bg-white border border-gray-200 rounded p-3">
                                        <h5 class="font-semibold text-gray-900 text-sm mb-1">üìä Custom (JSON)</h5>
                                        <p class="text-xs text-gray-600 mb-2">Structured data with custom schema</p>
                                        <p class="text-xs text-gray-700">
                                            <strong>Use for:</strong> API integrations, database inserts, structured reports<br>
                                            <strong>Example:</strong> Campaign plans, product catalogs, analytics data
                                        </p>
                                    </div>

                                    <div class="bg-white border border-gray-200 rounded p-3">
                                        <h5 class="font-semibold text-gray-900 text-sm mb-1">üìÑ Artifact (Text)</h5>
                                        <p class="text-xs text-gray-600 mb-2">Formatted documents and reports</p>
                                        <p class="text-xs text-gray-700">
                                            <strong>Use for:</strong> Long-form content, documentation, formatted reports<br>
                                            <strong>Example:</strong> Marketing briefs, strategy documents, proposals
                                        </p>
                                    </div>

                                    <div class="bg-white border border-gray-200 rounded p-3">
                                        <h5 class="font-semibold text-gray-900 text-sm mb-1">üñºÔ∏è Artifact (Image)</h5>
                                        <p class="text-xs text-gray-600 mb-2">Visual content generation</p>
                                        <p class="text-xs text-gray-700">
                                            <strong>Use for:</strong> Generated images, diagrams, visual assets<br>
                                            <strong>Example:</strong> Social media graphics, infographics
                                        </p>
                                    </div>

                                    <div class="bg-white border border-gray-200 rounded p-3">
                                        <h5 class="font-semibold text-gray-900 text-sm mb-1">üìà Artifact (React/Plotly)</h5>
                                        <p class="text-xs text-gray-600 mb-2">Interactive charts and visualizations</p>
                                        <p class="text-xs text-gray-700">
                                            <strong>Use for:</strong> Data visualization, interactive dashboards<br>
                                            <strong>Example:</strong> Performance charts, trend graphs, analytics dashboards<br>
                                            <strong>üí° Tip:</strong> Name output ":plotly:" to auto-render charts
                                        </p>
                                    </div>
                                </div>

                                <div class="mt-4 p-3 bg-yellow-50 border border-yellow-200 rounded">
                                    <p class="text-xs text-yellow-900">
                                        <strong>‚ö° Pro Tip:</strong> Start with default text output. Only add custom outputs when you need specific data structures or visualizations.
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Step 6: Prompt Variables (Optional) -->
                    <div class="step-content" data-step="6">
                        <h2 class="text-2xl font-bold text-indigo-900 mb-4">üìã Step 6: Prompt Variables (Optional)</h2>

                        <p class="text-gray-700 mb-4">
                            Inject dynamic data from knowledge bases directly into your agent's prompts.
                        </p>

                        <div class="bg-blue-50 border-l-4 border-blue-500 p-4 mb-6">
                            <p class="text-sm text-blue-900">
                                <strong>‚ÑπÔ∏è Note:</strong> Prompt variables are optional. Use them to provide schema context from your databases.
                            </p>
                        </div>

                        <div id="promptVariablesList" class="space-y-4 mb-6">
                            <!-- Prompt variables will be added here -->
                        </div>

                        <button id="addPromptVariableBtn" class="bg-indigo-600 hover:bg-indigo-700 text-white font-semibold py-3 px-6 rounded-lg transition-colors">
                            ‚ûï Add Prompt Variable
                        </button>

                        <div class="mt-6 bg-gray-50 rounded-lg p-4">
                            <h3 class="font-semibold text-gray-900 mb-2">Syntax Examples:</h3>
                            <ul class="text-sm font-mono text-gray-700 space-y-1">
                                <li>customers - All columns from customers table</li>
                                <li>products.{sku,name,price} - Only specified columns</li>
                                <li>behavior_*.* - All tables starting with "behavior_"</li>
                                <li>!*.internal_* - Exclude columns starting with "internal_"</li>
                            </ul>
                        </div>
                    </div>

                    <!-- Step 7: Download & Deploy -->
                    <div class="step-content" data-step="7">
                        <h2 class="text-2xl font-bold text-indigo-900 mb-4" data-i18n="step4.title">üöÄ Step 7: Download & Deploy</h2>

                        <div class="bg-green-50 border-l-4 border-green-500 p-4 mb-6">
                            <p class="text-sm text-green-900" data-i18n="step4.info">
                                <strong>‚úÖ Configuration Complete!</strong> Your AI agent is ready to deploy. Download all files and follow the deployment guide.
                            </p>
                        </div>

                        <div id="configSummary" class="bg-gray-50 rounded-lg p-6 mb-6">
                            <!-- Configuration summary will be inserted here -->
                        </div>

                        <div class="space-y-3">
                            <button id="viewOutputBtn" class="w-full bg-green-600 hover:bg-green-700 text-white font-semibold py-4 px-4 rounded-lg transition-colors duration-200 shadow-lg" data-i18n="button.viewoutput">
                                üìÑ View Copyable Output Webpage
                            </button>

                            <button id="downloadKBsBtn" class="w-full bg-indigo-600 hover:bg-indigo-700 text-white font-semibold py-3 px-4 rounded-lg transition-colors duration-200" data-i18n="button.downloadkbs">
                                üìö Download Knowledge Base Files (.md)
                            </button>
                            <button id="downloadProjectBtn" class="w-full bg-purple-600 hover:bg-purple-700 text-white font-semibold py-3 px-4 rounded-lg transition-colors duration-200" data-i18n="button.downloadproject">
                                üìã Download Project Setup Guide
                            </button>
                            <button id="downloadAgentBtn" class="w-full bg-pink-600 hover:bg-pink-700 text-white font-semibold py-3 px-4 rounded-lg transition-colors duration-200" data-i18n="button.downloadagent">
                                ü§ñ Download Agent Configuration
                            </button>
                            <button id="downloadAllBtn" class="w-full bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-700 hover:to-purple-700 text-white font-bold py-4 px-4 rounded-lg transition-all duration-200" data-i18n="button.downloadall">
                                ‚¨áÔ∏è Download All Files
                            </button>

                            <!-- Auto-Deploy Button (Coming Soon) -->
                            <button disabled class="w-full bg-gray-300 text-gray-500 font-semibold py-3 px-4 rounded-lg cursor-not-allowed opacity-60 relative">
                                <span data-i18n="button.autodeploy">üöÄ Auto-Deploy to Agent Foundry</span>
                                <span class="ml-2 text-xs bg-gray-400 text-white px-2 py-1 rounded" data-i18n="deploy.comingsoon">Coming Soon</span>
                            </button>
                        </div>

                        <div class="mt-6 bg-blue-50 border border-blue-200 rounded-lg p-4">
                            <h3 class="font-semibold text-blue-900 mb-2" data-i18n="deploy.steps">üìñ Next Steps:</h3>
                            <ol class="list-decimal list-inside text-sm text-blue-800 space-y-1">
                                <li data-i18n="deploy.step1">Download all files to your computer</li>
                                <li data-i18n="deploy.step2">Open Agent Foundry</li>
                                <li data-i18n="deploy.step3">Create new project (use PROJECT_SETUP.md guide)</li>
                                <li data-i18n="deploy.step4">Upload knowledge base files</li>
                                <li data-i18n="deploy.step5">Configure agent (use AGENT_CONFIG.md guide)</li>
                                <li data-i18n="deploy.step6">Test and deploy your agent!</li>
                            </ol>
                        </div>
                    </div>

                    <!-- Navigation Buttons -->
                    <div class="flex justify-between items-center mt-8 pt-6 border-t border-gray-200">
                        <button
                            id="prevBtn"
                            class="bg-gray-200 hover:bg-gray-300 text-gray-700 font-semibold py-2 px-6 rounded-lg transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed"
                            disabled
                            data-i18n="button.previous"
                        >
                            ‚Üê Previous
                        </button>
                        <div class="text-sm text-gray-500">
                            <span data-i18n="step.of">Step</span> <span id="currentStepNum">0</span> <span data-i18n="step.total">of 8</span>
                        </div>
                        <button
                            id="nextBtn"
                            class="bg-indigo-600 hover:bg-indigo-700 text-white font-semibold py-2 px-6 rounded-lg transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed"
                            data-i18n="button.next"
                        >
                            Next ‚Üí
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- JavaScript -->
    <script src="claude-api.js"></script>
    <script src="wizard-ai.js"></script>
</body>
</html>
